{
    "sourceFile": "src/components/EventEditModal.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 7,
            "patches": [
                {
                    "date": 1760512008148,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1760516530016,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,57 +1,145 @@\n-import { useState } from 'react';\n-import { Modal, Form, Button } from 'react-bootstrap';\n+import { useEffect, useState } from 'react';\n+import { Modal, Form, Button, Row, Col } from 'react-bootstrap';\n import { updateEvent } from '../api/eventApi';\n \n-export default function EventEditModal({ show, onHide, event, refresh }) {\n-  const [form, setForm] = useState(event || {});\n-  const [loading, setLoading] = useState(false);\n+export default function EventEditModal({ show, onClose, event, onUpdated }) {\n+  const [form, setForm] = useState({});\n+  const [files, setFiles] = useState([]);\n \n-  const handleChange = (e) => {\n-    const { name, value } = e.target;\n-    setForm({ ...form, [name]: value });\n-  };\n+  useEffect(() => {\n+    if (event) {\n+      setForm({\n+        title: event.title || '',\n+        description: event.description || '',\n+        department: event.department || '',\n+        type: event.type || '',\n+        startAt: event.startAt ? event.startAt.slice(0,16) : '',\n+        endAt: event.endAt ? event.endAt.slice(0,16) : '',\n+        location: event.location?.name || '',\n+        organizerName: event.organizer?.name || '',\n+        organizerCompany: event.organizer?.company || '',\n+        organizerEmail: event.organizer?.email || '',\n+      });\n+      setFiles([]);\n+    }\n+  }, [event]);\n \n-  const handleSubmit = async () => {\n-    setLoading(true);\n-    await updateEvent(event._id, form);\n-    setLoading(false);\n-    refresh();\n-    onHide();\n+  const change = e => setForm(f => ({ ...f, [e.target.name]: e.target.value }));\n+  const onFile = (e) => setFiles(Array.from(e.target.files || []));\n+\n+  const submit = async (e) => {\n+    e.preventDefault();\n+    // If admin selected new files -> send multipart; else send JSON\n+    if (files.length) {\n+      const fd = new FormData();\n+      Object.entries(form).forEach(([k,v]) => fd.append(k, v ?? ''));\n+      files.forEach(f => fd.append('media', f));\n+      await updateEvent(event._id, fd);\n+    } else {\n+      await updateEvent(event._id, {\n+        ...form,\n+        organizer: {\n+          name: form.organizerName,\n+          company: form.organizerCompany,\n+          email: form.organizerEmail\n+        },\n+        location: { name: form.location }\n+      });\n+    }\n+    onUpdated?.();\n+    onClose();\n   };\n \n+  if (!event) return null;\n+\n   return (\n-    <Modal show={show} onHide={onHide} centered>\n-      <Modal.Header closeButton>\n-        <Modal.Title>Edit Event</Modal.Title>\n-      </Modal.Header>\n-      <Modal.Body>\n-        <Form>\n-          <Form.Group className=\"mb-3\">\n+    <Modal show={show} onHide={onClose} centered>\n+      <Form onSubmit={submit}>\n+        <Modal.Header closeButton><Modal.Title>Edit Event</Modal.Title></Modal.Header>\n+        <Modal.Body>\n+          <Form.Group className=\"mb-2\">\n             <Form.Label>Title</Form.Label>\n-            <Form.Control name=\"title\" value={form.title || ''} onChange={handleChange} />\n+            <Form.Control name=\"title\" value={form.title} onChange={change} required />\n           </Form.Group>\n-          <Form.Group className=\"mb-3\">\n+\n+          <Form.Group className=\"mb-2\">\n             <Form.Label>Description</Form.Label>\n-            <Form.Control as=\"textarea\" name=\"description\" value={form.description || ''} onChange={handleChange} />\n+            <Form.Control as=\"textarea\" rows={3} name=\"description\" value={form.description} onChange={change} />\n           </Form.Group>\n-          <Form.Group className=\"mb-3\">\n-            <Form.Label>Department</Form.Label>\n-            <Form.Select name=\"department\" value={form.department || ''} onChange={handleChange}>\n-              <option value=\"\">Select Department</option>\n-              <option value=\"IT\">IT</option>\n-              <option value=\"CS\">CS</option>\n-              <option value=\"ME\">ME</option>\n-              <option value=\"Other\">Other</option>\n-            </Form.Select>\n+\n+          <Row className=\"g-2\">\n+            <Col md={6}>\n+              <Form.Group className=\"mb-2\">\n+                <Form.Label>Department</Form.Label>\n+                <Form.Select name=\"department\" value={form.department} onChange={change} required>\n+                  <option value=\"\">Select Department</option>\n+                  <option value=\"IT\">IT</option>\n+                  <option value=\"CS\">CS</option>\n+                  <option value=\"ME\">ME</option>\n+                  <option value=\"Other\">Other</option>\n+                </Form.Select>\n+              </Form.Group>\n+            </Col>\n+            <Col md={6}>\n+              <Form.Group className=\"mb-2\">\n+                <Form.Label>Type</Form.Label>\n+                <Form.Control name=\"type\" value={form.type} onChange={change} placeholder=\"talk / workshop / contest\" />\n+              </Form.Group>\n+            </Col>\n+          </Row>\n+\n+          <Row className=\"g-2\">\n+            <Col md={6}>\n+              <Form.Group className=\"mb-2\">\n+                <Form.Label>Start</Form.Label>\n+                <Form.Control type=\"datetime-local\" name=\"startAt\" value={form.startAt} onChange={change} />\n+              </Form.Group>\n+            </Col>\n+            <Col md={6}>\n+              <Form.Group className=\"mb-2\">\n+                <Form.Label>End</Form.Label>\n+                <Form.Control type=\"datetime-local\" name=\"endAt\" value={form.endAt} onChange={change} />\n+              </Form.Group>\n+            </Col>\n+          </Row>\n+\n+          <Form.Group className=\"mb-2\">\n+            <Form.Label>Location</Form.Label>\n+            <Form.Control name=\"location\" value={form.location} onChange={change} />\n           </Form.Group>\n-        </Form>\n-      </Modal.Body>\n-      <Modal.Footer>\n-        <Button variant=\"secondary\" onClick={onHide}>Cancel</Button>\n-        <Button variant=\"primary\" disabled={loading} onClick={handleSubmit}>\n-          {loading ? 'Updating…' : 'Update'}\n-        </Button>\n-      </Modal.Footer>\n+\n+          <Row className=\"g-2\">\n+            <Col md={4}>\n+              <Form.Group className=\"mb-2\">\n+                <Form.Label>Organizer Name</Form.Label>\n+                <Form.Control name=\"organizerName\" value={form.organizerName} onChange={change} />\n+              </Form.Group>\n+            </Col>\n+            <Col md={4}>\n+              <Form.Group className=\"mb-2\">\n+                <Form.Label>Company</Form.Label>\n+                <Form.Control name=\"organizerCompany\" value={form.organizerCompany} onChange={change} />\n+              </Form.Group>\n+            </Col>\n+            <Col md={4}>\n+              <Form.Group className=\"mb-2\">\n+                <Form.Label>Email</Form.Label>\n+                <Form.Control type=\"email\" name=\"organizerEmail\" value={form.organizerEmail} onChange={change} />\n+              </Form.Group>\n+            </Col>\n+          </Row>\n+\n+          <Form.Group className=\"mb-1\">\n+            <Form.Label>Replace media (optional)</Form.Label>\n+            <Form.Control type=\"file\" accept=\"image/*,video/*\" multiple onChange={onFile}/>\n+            <div className=\"form-text\">If you select files here, the existing media will be replaced.</div>\n+          </Form.Group>\n+        </Modal.Body>\n+        <Modal.Footer>\n+          <Button variant=\"secondary\" onClick={onClose}>Cancel</Button>\n+          <Button type=\"submit\" variant=\"primary\">Update</Button>\n+        </Modal.Footer>\n+      </Form>\n     </Modal>\n   );\n }\n"
                },
                {
                    "date": 1761129796593,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -102,13 +102,22 @@\n               </Form.Group>\n             </Col>\n           </Row>\n \n-          <Form.Group className=\"mb-2\">\n-            <Form.Label>Location</Form.Label>\n-            <Form.Control name=\"location\" value={form.location} onChange={change} />\n-          </Form.Group>\n+          // In CreateEventModal.jsx and EventEditModal.jsx\n+<Form.Group className=\"mb-3\">\n+  <Form.Label>Location <small className=\"text-muted\">(text or Google Maps iframe)</small></Form.Label>\n+  <Form.Control\n+    name=\"location\"\n+    as=\"textarea\"        // if you prefer single-line keep it \"type='text'\"\n+    rows={2}\n+    placeholder='e.g. \"Auditorium\" or paste Google Maps <iframe ... ></iframe>'\n+    value={form.location || ''}\n+    onChange={onChange}\n+  />\n+</Form.Group>\n \n+\n           <Row className=\"g-2\">\n             <Col md={4}>\n               <Form.Group className=\"mb-2\">\n                 <Form.Label>Organizer Name</Form.Label>\n"
                },
                {
                    "date": 1761129831320,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -102,22 +102,13 @@\n               </Form.Group>\n             </Col>\n           </Row>\n \n-          // In CreateEventModal.jsx and EventEditModal.jsx\n-<Form.Group className=\"mb-3\">\n-  <Form.Label>Location <small className=\"text-muted\">(text or Google Maps iframe)</small></Form.Label>\n-  <Form.Control\n-    name=\"location\"\n-    as=\"textarea\"        // if you prefer single-line keep it \"type='text'\"\n-    rows={2}\n-    placeholder='e.g. \"Auditorium\" or paste Google Maps <iframe ... ></iframe>'\n-    value={form.location || ''}\n-    onChange={onChange}\n-  />\n-</Form.Group>\n+          <Form.Group className=\"mb-2\">\n+            <Form.Label>Location</Form.Label>\n+            <Form.Control name=\"location\" value={form.location} onChange={change} />\n+          </Form.Group>\n \n-\n           <Row className=\"g-2\">\n             <Col md={4}>\n               <Form.Group className=\"mb-2\">\n                 <Form.Label>Organizer Name</Form.Label>\n"
                },
                {
                    "date": 1761129850375,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -102,13 +102,22 @@\n               </Form.Group>\n             </Col>\n           </Row>\n \n-          <Form.Group className=\"mb-2\">\n-            <Form.Label>Location</Form.Label>\n-            <Form.Control name=\"location\" value={form.location} onChange={change} />\n-          </Form.Group>\n+          // In CreateEventModal.jsx and EventEditModal.jsx\n+<Form.Group className=\"mb-3\">\n+  <Form.Label>Location <small className=\"text-muted\">(text or Google Maps iframe)</small></Form.Label>\n+  <Form.Control\n+    name=\"location\"\n+    as=\"textarea\"        // if you prefer single-line keep it \"type='text'\"\n+    rows={2}\n+    placeholder='e.g. \"Auditorium\" or paste Google Maps <iframe ... ></iframe>'\n+    value={form.location || ''}\n+    onChange={onChange}\n+  />\n+</Form.Group>\n \n+\n           <Row className=\"g-2\">\n             <Col md={4}>\n               <Form.Group className=\"mb-2\">\n                 <Form.Label>Organizer Name</Form.Label>\n"
                },
                {
                    "date": 1761129871268,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -102,18 +102,18 @@\n               </Form.Group>\n             </Col>\n           </Row>\n \n-          // In CreateEventModal.jsx and EventEditModal.jsx\n+          {/* // In CreateEventModal.jsx and EventEditModal.jsx */}\n <Form.Group className=\"mb-3\">\n   <Form.Label>Location <small className=\"text-muted\">(text or Google Maps iframe)</small></Form.Label>\n   <Form.Control\n     name=\"location\"\n     as=\"textarea\"        // if you prefer single-line keep it \"type='text'\"\n     rows={2}\n     placeholder='e.g. \"Auditorium\" or paste Google Maps <iframe ... ></iframe>'\n     value={form.location || ''}\n-    onChange={onChange}\n+    onChange={change}\n   />\n </Form.Group>\n \n \n"
                },
                {
                    "date": 1761281319836,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -107,9 +107,9 @@\n <Form.Group className=\"mb-3\">\n   <Form.Label>Location <small className=\"text-muted\">(text or Google Maps iframe)</small></Form.Label>\n   <Form.Control\n     name=\"location\"\n-    as=\"textarea\"        // if you prefer single-line keep it \"type='text'\"\n+    as=\"textarea\"        \n     rows={2}\n     placeholder='e.g. \"Auditorium\" or paste Google Maps <iframe ... ></iframe>'\n     value={form.location || ''}\n     onChange={change}\n"
                },
                {
                    "date": 1761281330901,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,9 +28,9 @@\n   const onFile = (e) => setFiles(Array.from(e.target.files || []));\n \n   const submit = async (e) => {\n     e.preventDefault();\n-    // If admin selected new files -> send multipart; else send JSON\n+   \n     if (files.length) {\n       const fd = new FormData();\n       Object.entries(form).forEach(([k,v]) => fd.append(k, v ?? ''));\n       files.forEach(f => fd.append('media', f));\n@@ -102,9 +102,9 @@\n               </Form.Group>\n             </Col>\n           </Row>\n \n-          {/* // In CreateEventModal.jsx and EventEditModal.jsx */}\n+         \n <Form.Group className=\"mb-3\">\n   <Form.Label>Location <small className=\"text-muted\">(text or Google Maps iframe)</small></Form.Label>\n   <Form.Control\n     name=\"location\"\n"
                }
            ],
            "date": 1760512008148,
            "name": "Commit-0",
            "content": "import { useState } from 'react';\nimport { Modal, Form, Button } from 'react-bootstrap';\nimport { updateEvent } from '../api/eventApi';\n\nexport default function EventEditModal({ show, onHide, event, refresh }) {\n  const [form, setForm] = useState(event || {});\n  const [loading, setLoading] = useState(false);\n\n  const handleChange = (e) => {\n    const { name, value } = e.target;\n    setForm({ ...form, [name]: value });\n  };\n\n  const handleSubmit = async () => {\n    setLoading(true);\n    await updateEvent(event._id, form);\n    setLoading(false);\n    refresh();\n    onHide();\n  };\n\n  return (\n    <Modal show={show} onHide={onHide} centered>\n      <Modal.Header closeButton>\n        <Modal.Title>Edit Event</Modal.Title>\n      </Modal.Header>\n      <Modal.Body>\n        <Form>\n          <Form.Group className=\"mb-3\">\n            <Form.Label>Title</Form.Label>\n            <Form.Control name=\"title\" value={form.title || ''} onChange={handleChange} />\n          </Form.Group>\n          <Form.Group className=\"mb-3\">\n            <Form.Label>Description</Form.Label>\n            <Form.Control as=\"textarea\" name=\"description\" value={form.description || ''} onChange={handleChange} />\n          </Form.Group>\n          <Form.Group className=\"mb-3\">\n            <Form.Label>Department</Form.Label>\n            <Form.Select name=\"department\" value={form.department || ''} onChange={handleChange}>\n              <option value=\"\">Select Department</option>\n              <option value=\"IT\">IT</option>\n              <option value=\"CS\">CS</option>\n              <option value=\"ME\">ME</option>\n              <option value=\"Other\">Other</option>\n            </Form.Select>\n          </Form.Group>\n        </Form>\n      </Modal.Body>\n      <Modal.Footer>\n        <Button variant=\"secondary\" onClick={onHide}>Cancel</Button>\n        <Button variant=\"primary\" disabled={loading} onClick={handleSubmit}>\n          {loading ? 'Updating…' : 'Update'}\n        </Button>\n      </Modal.Footer>\n    </Modal>\n  );\n}\n"
        }
    ]
}